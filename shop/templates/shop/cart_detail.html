{% extends "base.html" %}
{% block title %}Your Cart{% endblock %}
{% block content %}
<h2>Your Shopping Cart</h2>
{% if cart.items.count > 0 %}
<table class="table table-striped">
  <thead>
    <tr>
      <th>Product</th>
      <th>Price</th>
      <th style="width:120px;">Quantity</th>
      <th>Total</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for item in cart.items.all %}
      <tr>
        <td><a href="{{ item.product.get_absolute_url }}">{{ item.product.title }}</a></td>
        <td>${{ item.product.price }}</td>
        <td>
          <form method="post" action="{% url 'shop:update_cart' item.id %}" class="d-flex">
            {% csrf_token %}
            <input type="number" name="quantity" value="{{ item.quantity }}" min="0" class="form-control form-control-sm me-2" style="width:70px;">
            <button type="submit" class="btn btn-sm btn-primary">Update</button>
          </form>
        </td>
        <td>${{ item.total_price }}</td>
        <td>
          <a href="{% url 'shop:remove_from_cart' item.id %}" class="btn btn-sm btn-danger">Remove</a>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
<h4 class="text-end">Cart Total: ${{ cart.total }}</h4>
<a href="{% url 'shop:checkout' %}" class="btn btn-success float-end">Checkout</a>
{% else %}
<p>Your cart is empty. <a href="{% url 'shop:product_list' %}">Continue shopping.</a></p>
{% endif %}
{% endblock %}
